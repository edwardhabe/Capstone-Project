---
title: Exploratory Phase
output: html_notebook
---

First, I'll begin by setting up any packages I need and clearing R's brain. 

```{r}
rm(list = ls())
library(here)
library(tidyverse)
library(ggfortify)
```

Now, to import my data, ensuring that I turn on "stringsAsFactors=TRUE"

```{r}
Bacteria_Data <- read.csv(here("Data", "AS-Raw-Data-Indicator-bacteria-project.csv"), stringsAsFactors=TRUE)
```


```{r}
as.factor(Bacteria_Data$pH)
as.factor(Bacteria_Data$Temperature)
as.factor(Bacteria_Data$Coliform_MPN)
```

The first variable I'll look into is pH. Using a histogram, I can look for outliers and get a better idea of how my data looks. 

```{r}
ggplot(Bacteria_Data, aes(x=pH)) +
  geom_histogram()

## This data looks pretty consistent within a certain range. However, there may be a couple outliers on the lower end of the scale. 
```

Now, I'll look at Temperature using another histogram. 
```{r}
ggplot(Bacteria_Data, aes(x=Temperature)) +
  geom_histogram()

## Again, this data looks pretty consistent. On the higher end of the range, there could be some outliers to look out for. 
```

For my last variable, I'll look at total coliform count. 


```{r}
ggplot(Bacteria_Data, aes(x=Coliform_MPN)) + 
  geom_histogram()

##Things are pretty consistent here besides a major outlier I can identify. That one's at around 80,000 MPN and could carry some high leverage. 
```
Next, to get an overall summary of my data for assessment of all variables and their statistics. 

```{r}
summary(Bacteria_Data)

## The summary() function shows important information about data such as min, max, and quartiles. This is useful in assessing the quality of data, and also determining if there are any NA's in a larger data set. I'm noticing that there are some NA values, and that max values are very different from means in some variables, such as coliform count (nearly 60,000 MPN difference). Things like this should be taken into account when searching for potential outliers. 
```

```{r}
ggplot(Bacteria_Data, aes(x=Temperature, y=Coliform_MPN)) +
  geom_point() +
  theme_bw()
```
```{r}
Temperature_mod <- lm(Temperature ~ Coliform_MPN, data=Bacteria_Data)
```

```{r}
autoplot(Temperature_mod)
```

```{r}
anova(Temperature_mod)
```

```{r}
summary(Temperature_mod)
```

```{r}
ggplot(Bacteria_Data, aes(x=pH, y=Coliform_MPN)) +
  geom_point()+
  theme_bw()
```

```{r}
pH_mod <- lm(pH ~ Coliform_MPN, data=Bacteria_Data)
```

```{r}
autoplot(pH_mod)
```

```{r}
anova(pH_mod)
```

```{r}
summary(pH_mod)
```

```{r}
ggplot(Bacteria_Data, aes(x=Ecoli_MPN))+
  geom_histogram()
```

```{r}
ggplot(Bacteria_Data, aes(x=Temperature, y=Ecoli_MPN)) +
         geom_point()+
         theme_bw()
```

```{r}
Temp_Ecoli_mod <- lm(Temperature ~ Ecoli_MPN, data = Bacteria_Data)
```

```{r}
autoplot(Temp_Ecoli_mod)
```

```{r}
anova(Temp_Ecoli_mod)
```

```{r}
ggplot(Bacteria_Data, aes(x=pH, y=Ecoli_MPN)) +
  geom_point()+
  theme_bw()
```

```{r}
pH_Ecoli_mod <- lm(pH ~ Ecoli_MPN, data=Bacteria_Data)
```

```{r}
autoplot(pH_Ecoli_mod)
```

```{r}
anova(pH_Ecoli_mod)
```

```{r}
Coliform_wo_Outliers <- filter(Bacteria_Data, Coliform_MPN < 80000)
```

```{r}
ggplot(Coliform_wo_Outliers, aes(x=Temperature, y=Coliform_MPN)) +
  geom_point()+
  theme_bw()
```

```{r}
Temp_coli_wo_outliers_mod <- lm(Temperature ~ Coliform_MPN, data=Coliform_wo_Outliers)
```

```{r}
autoplot(Temp_coli_wo_outliers_mod)
```

```{r}
anova(Temp_coli_wo_outliers_mod)
```

```{r}
pH_coli_wo_outliers <- lm(pH ~ Coliform_MPN, data=Coliform_wo_Outliers)
```
```{r}
autoplot(pH_coli_wo_outliers)
```

```{r}
anova(pH_coli_wo_outliers)
```

```{r}
Ecoli_wo_outliers <- filter(Bacteria_Data, Ecoli_MPN <40000)
```

```{r}
temp_Ecoli_wo_outliers <- lm(Temperature ~ Ecoli_MPN, data=Ecoli_wo_outliers)
```
```{r}
autoplot(temp_Ecoli_wo_outliers)
```

```{r}
anova(temp_Ecoli_wo_outliers)
```

```{r}
pH_Ecoli_wo_outliers <- lm(pH ~ Ecoli_MPN, data=Ecoli_wo_outliers)
```

```{r}
autoplot(pH_Ecoli_wo_outliers)
```
```{r}
anova(pH_Ecoli_wo_outliers)
```

